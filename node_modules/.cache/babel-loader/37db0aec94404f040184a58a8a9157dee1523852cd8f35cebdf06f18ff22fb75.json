{"ast":null,"code":"import _objectSpread from\"/Users/viktoriakvasova/Desktop/vitrina-app/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import{useEffect,useState}from'react';import Cart from'./Cart';import BasketList from'./BasketList';import Alert from'./Alert';import{API_URL,API_KEY,VB_TO_RUB}from'../config';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";function Shop(){const[goods,setGoods]=useState([]);const[loading,setLoading]=useState(true);const[order,setOrder]=useState([]);const[isBasketShow,setBasketShow]=useState(false);const[alertName,setAlertName]=useState('');useEffect(()=>{fetch(API_URL,{headers:{Authorization:API_KEY}}).then(res=>res.json()).then(data=>{if(data.shop){setGoods(data.shop);}setLoading(false);}).catch(err=>{console.error('Ошибка при загрузке товаров:',err);setLoading(false);});},[]);const addToBasket=item=>{const itemIndex=order.findIndex(el=>el.mainId===item.mainId);if(itemIndex<0){const newItem=_objectSpread(_objectSpread({},item),{},{quantity:1});setOrder([...order,newItem]);}else{const newOrder=order.map((el,index)=>{if(index===itemIndex){return _objectSpread(_objectSpread({},el),{},{quantity:el.quantity+1});}else{return el;}});setOrder(newOrder);}setAlertName(item.displayName);// показать уведомление\n};const removeFromBasket=itemId=>{setOrder(order.filter(item=>item.mainId!==itemId));};const incQuantity=itemId=>{const newOrder=order.map(el=>{if(el.mainId===itemId){return _objectSpread(_objectSpread({},el),{},{quantity:el.quantity+1});}return el;});setOrder(newOrder);};const decQuantity=itemId=>{const newOrder=order.map(el=>{if(el.mainId===itemId){return _objectSpread(_objectSpread({},el),{},{quantity:el.quantity>1?el.quantity-1:1});}return el;});setOrder(newOrder);};const closeAlert=()=>{setAlertName('');};return/*#__PURE__*/_jsxs(\"main\",{className:\"container my-4 position-relative\",children:[/*#__PURE__*/_jsx(Cart,{quantity:order.reduce((acc,item)=>acc+item.quantity,0),handleBasketShow:()=>setBasketShow(!isBasketShow)}),isBasketShow&&/*#__PURE__*/_jsx(BasketList,{order:order,handleBasketShow:()=>setBasketShow(false),removeFromBasket:removeFromBasket,incQuantity:incQuantity,decQuantity:decQuantity}),alertName&&/*#__PURE__*/_jsx(Alert,{name:alertName,closeAlert:closeAlert}),/*#__PURE__*/_jsx(\"h2\",{children:\"\\u041C\\u0430\\u0433\\u0430\\u0437\\u0438\\u043D \"}),loading?/*#__PURE__*/_jsx(\"h5\",{children:\"\\u0417\\u0430\\u0433\\u0440\\u0443\\u0437\\u043A\\u0430 \\u0442\\u043E\\u0432\\u0430\\u0440\\u043E\\u0432...\"}):/*#__PURE__*/_jsx(\"div\",{className:\"row\",children:goods.length>0?goods.map(item=>{var _item$displayAssets$;return/*#__PURE__*/_jsx(\"div\",{className:\"col-md-4 mb-4\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"card h-100\",children:[/*#__PURE__*/_jsx(\"img\",{src:(_item$displayAssets$=item.displayAssets[0])===null||_item$displayAssets$===void 0?void 0:_item$displayAssets$.url,className:\"card-img-top\",alt:item.displayName}),/*#__PURE__*/_jsxs(\"div\",{className:\"card-body\",children:[/*#__PURE__*/_jsx(\"h5\",{className:\"card-title\",children:item.displayName}),/*#__PURE__*/_jsxs(\"p\",{className:\"card-text\",children:[\"\\u0426\\u0435\\u043D\\u0430: \",(item.price.finalPrice*VB_TO_RUB).toFixed(0),\" \\u20BD\"]}),/*#__PURE__*/_jsx(\"button\",{className:\"btn custom-buy-button\",back:true,onClick:()=>addToBasket(item),children:\"\\u041A\\u0443\\u043F\\u0438\\u0442\\u044C\"})]})]})},item.mainId);}):/*#__PURE__*/_jsx(\"p\",{children:\"\\u041D\\u0435\\u0442 \\u0434\\u043E\\u0441\\u0442\\u0443\\u043F\\u043D\\u044B\\u0445 \\u0442\\u043E\\u0432\\u0430\\u0440\\u043E\\u0432\"})})]});}export default Shop;","map":{"version":3,"names":["useEffect","useState","Cart","BasketList","Alert","API_URL","API_KEY","VB_TO_RUB","jsx","_jsx","jsxs","_jsxs","Shop","goods","setGoods","loading","setLoading","order","setOrder","isBasketShow","setBasketShow","alertName","setAlertName","fetch","headers","Authorization","then","res","json","data","shop","catch","err","console","error","addToBasket","item","itemIndex","findIndex","el","mainId","newItem","_objectSpread","quantity","newOrder","map","index","displayName","removeFromBasket","itemId","filter","incQuantity","decQuantity","closeAlert","className","children","reduce","acc","handleBasketShow","name","length","_item$displayAssets$","src","displayAssets","url","alt","price","finalPrice","toFixed","back","onClick"],"sources":["/Users/viktoriakvasova/Desktop/vitrina-app/src/components/Shop.jsx"],"sourcesContent":["import { useEffect, useState } from 'react';\nimport Cart from './Cart';\nimport BasketList from './BasketList';\nimport Alert from './Alert';\nimport { API_URL, API_KEY, VB_TO_RUB } from '../config';\n\n\n\nfunction Shop() {\n    const [goods, setGoods] = useState([]);\n    const [loading, setLoading] = useState(true);\n    const [order, setOrder] = useState([]);\n    const [isBasketShow, setBasketShow] = useState(false);\n    const [alertName, setAlertName] = useState('');\n\n    useEffect(() => {\n        fetch(API_URL, {\n        headers: {\n            Authorization: API_KEY,\n        },\n        })\n        .then((res) => res.json())\n        .then((data) => {\n            if (data.shop) {\n            setGoods(data.shop);\n            }\n            setLoading(false);\n        })\n        .catch((err) => {\n            console.error('Ошибка при загрузке товаров:', err);\n            setLoading(false);\n        });\n    }, []);\n\n    const addToBasket = (item) => {\n        const itemIndex = order.findIndex((el) => el.mainId === item.mainId);\n\n        if (itemIndex < 0) {\n        const newItem = {\n            ...item,\n            quantity: 1,\n        };\n        setOrder([...order, newItem]);\n        } else {\n        const newOrder = order.map((el, index) => {\n            if (index === itemIndex) {\n            return {\n                ...el,\n                quantity: el.quantity + 1,\n            };\n            } else {\n            return el;\n            }\n        });\n        setOrder(newOrder);\n        }\n\n        setAlertName(item.displayName); // показать уведомление\n    };\n\n    const removeFromBasket = (itemId) => {\n        setOrder(order.filter((item) => item.mainId !== itemId));\n    };\n\n    const incQuantity = (itemId) => {\n        const newOrder = order.map((el) => {\n        if (el.mainId === itemId) {\n            return { ...el, quantity: el.quantity + 1 };\n        }\n        return el;\n        });\n        setOrder(newOrder);\n    };\n\n    const decQuantity = (itemId) => {\n        const newOrder = order.map((el) => {\n        if (el.mainId === itemId) {\n            return { ...el, quantity: el.quantity > 1 ? el.quantity - 1 : 1 };\n        }\n        return el;\n        });\n        setOrder(newOrder);\n    };\n\n    const closeAlert = () => {\n        setAlertName('');\n    };\n\n    return (\n        <main className=\"container my-4 position-relative\">\n        <Cart\n            quantity={order.reduce((acc, item) => acc + item.quantity, 0)}\n            handleBasketShow={() => setBasketShow(!isBasketShow)}\n        />\n\n        {isBasketShow && (\n            <BasketList\n            order={order}\n            handleBasketShow={() => setBasketShow(false)}\n            removeFromBasket={removeFromBasket}\n            incQuantity={incQuantity}\n            decQuantity={decQuantity}\n            />\n        )}\n\n        {alertName && <Alert name={alertName} closeAlert={closeAlert} />}\n\n        <h2>Магазин </h2>\n        {loading ? (\n            <h5>Загрузка товаров...</h5>\n        ) : (\n            <div className=\"row\">\n            {goods.length > 0 ? (\n                goods.map((item) => (\n                <div className=\"col-md-4 mb-4\" key={item.mainId}>\n                    <div className=\"card h-100\">\n                    <img\n                        src={item.displayAssets[0]?.url}\n                        className=\"card-img-top\"\n                        alt={item.displayName}\n                    />\n                    <div className=\"card-body\">\n                        <h5 className=\"card-title\">{item.displayName}</h5>\n                        <p className=\"card-text\">\n                        Цена: {(item.price.finalPrice * VB_TO_RUB).toFixed(0)} ₽\n                        </p>\n                        <button\n                        className=\"btn custom-buy-button\" back\n                        onClick={() => addToBasket(item)}\n                        >\n                        Купить\n                        </button>\n                    </div>\n                    </div>\n                </div>\n                ))\n            ) : (\n                <p>Нет доступных товаров</p>\n            )}\n            </div>\n        )}\n        </main>\n    );\n}\n\nexport default Shop;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}